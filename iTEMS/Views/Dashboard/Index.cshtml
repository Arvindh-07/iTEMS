@using iTEMS.ViewModels
@model DashboardViewModel

@{
    ViewData["Title"] = "Dashboard";
}

<h1>Dashboard</h1>
<br />
<div>
    <h1>Projects Overview</h1>
</div>
<br />
<div class="row">
    <div class="col-md-4">
        <div class="card">
            <div class="card-header">Total Projects</div>
            <div class="card-body">@Model.TotalProjects</div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card">
            <div class="card-header">Projects in Planning Phase</div>
            <div class="card-body">@Model.PlanningProjects</div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card">
            <div class="card-header">Pending Projects</div>
            <div class="card-body">@Model.PendingProjects</div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card">
            <div class="card-header">Delayed Projects</div>
            <div class="card-body">@Model.DelayedProjects</div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card">
            <div class="card-header">Blocked Projects</div>
            <div class="card-body">@Model.BlockedProjects</div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card">
            <div class="card-header">Completed Projects</div>
            <div class="card-body">@Model.CompletedProjects</div>
        </div>
    </div>
</div>
<br />
<div>
    <h1>Tasks Overview</h1>
</div>
<br />
<div class="row mt-4">
    <div class="col-md-4">
        <div class="card">
            <div class="card-header">Total Tasks</div>
            <div class="card-body">@Model.TotalTasks</div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card">
            <div class="card-header">Tasks in Planning Phase</div>
            <div class="card-body">@Model.PlanningTasks</div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card">
            <div class="card-header">Pending Tasks</div>
            <div class="card-body">@Model.PendingTasks</div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card">
            <div class="card-header">Delayed Tasks</div>
            <div class="card-body">@Model.DelayedTasks</div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card">
            <div class="card-header">Blocked Tasks</div>
            <div class="card-body">@Model.BlockedTasks</div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card">
            <div class="card-header">Completed Tasks</div>
            <div class="card-body">@Model.CompletedTasks</div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-md-6">
        <h2>Active Projects</h2>
        <ul class="list-group">
            @foreach (var project in Model.ActiveProjectsList)
            {
                <li class="list-group-item">@project.Name</li>
            }
        </ul>
    </div>
    <div class="col-md-6">
        <h2>Active Tasks</h2>
        <ul class="list-group">
            @foreach (var task in Model.ActiveTasksList)
            {
                <li class="list-group-item">@task.Title</li>
            }
        </ul>
    </div>
</div>

<div class="row mt-4">
    <div class="col-md-12">
        <h2>Team Members</h2>
        <ul class="list-group">
            @foreach (var member in Model.TeamMembers)
            {
                <li class="list-group-item">
                    <strong>@member.UserName</strong>

                    <ul class="list-group mt-2">
                        <li class="list-group-item active">Projects:</li>
                        @if (Model.TeamMembersProjects.ContainsKey(member) && Model.TeamMembersProjects[member].Any())
                        {
                            @foreach (var project in Model.TeamMembersProjects[member].Where(p => p.Status != ProjectStatus.Completed))
                            {
                                <li class="list-group-item">@project.Name</li>
                            }
                        }
                        else
                        {
                            <li class="list-group-item">No projects assigned</li>
                        }
                    </ul>

                    <ul class="list-group mt-2">
                        <li class="list-group-item active">Tasks:</li>
                        @if (Model.TeamMembersTasks.ContainsKey(member) && Model.TeamMembersTasks[member].Any())
                        {
                            @foreach (var task in Model.TeamMembersTasks[member].Where(t => t.Status != TaskTracker.TaskTrackerStatus.Completed.ToString()))
                            {
                                <li class="list-group-item">@task.Title (@task.Status)</li>
                            }
                        }
                        else
                        {
                            <li class="list-group-item">No tasks assigned</li>
                        }
                    </ul>
                </li>
            }
        </ul>
    </div>
</div>

